Create a premium, highly attractive, and fully mobile-responsive single-page web application called "ESN Regression Studio" for managing an autoregressive Echo State Network (ESN) library. The application should be built with HTML, Tailwind CSS (via CDN), and vanilla JavaScript. Use emojis exclusively instead of SVG icons throughout the entire interface. The website has to be really beautiful; exaggerate the use of graphics, visual elements, formatting styles, components, emojis, etc. All numeric inputs should be standard number inputs without range sliders to avoid limiting values to specific intervals.

---

**HEADER SECTION:**

Design a sticky glass-morphism header with blur backdrop effect. Include:

- A gradient logo container (blue-500 via indigo-500 to purple-600) with rounded-xl corners, containing a üìä emoji, with a colored shadow (blue-500/30)
- App title "ESN Studio" in bold with subtitle "Autoregressive Forecasting" in smaller muted text below
- Model status badge showing a pulsing dot indicator (slate when no model, emerald when model exists) with status text ("No Model" or sample count like "150 steps")
- "Predict" button with gradient (blue-500 to indigo-600) and ‚ö° emoji, hidden until model exists
- Configure button with ‚öôÔ∏è emoji opening configuration modal
- Menu button with ‚ò∞ emoji opening slide-out menu
- Theme toggle button with üåô emoji for light mode and ‚òÄÔ∏è emoji for dark mode

All buttons must have touch-target class ensuring minimum 44x44px touch area. Header should have subtle bottom border with transparency.

---

**MAIN VISUALIZATION AREA:**

Create a tabbed visualization system with five mode buttons in a horizontally scrollable container:

1. "Small Multiples" / "Grid" (üìä emoji) - shows all dimensions in a grid layout
2. "Focus View" / "Focus" (üîç emoji) - single dimension detailed view with confidence intervals
3. "Heatmap" (üå°Ô∏è emoji) - color-coded matrix of all predictions
4. "Uncertainty" / "CI" (üìà emoji) - uncertainty/confidence visualization
5. "Snapshot" (üì∑ emoji) - bar chart for single time step

Active tab should have gradient background (blue-500 to indigo-600) with white text and shadow. Inactive tabs should have slate-100/dark:slate-700 background.

Below tabs, include a large chart container with:
- White/dark rounded-2xl card with shadow-xl and subtle border
- HTML5 Canvas element filling the container for chart rendering
- Floating chart controls panel (top-right) with zoom buttons: ‚ûï (zoom in), ‚ûñ (zoom out), üîÑ (reset zoom) - only visible when predictions exist
- Zoom level badge (top-left) showing percentage like "150%" when zoomed
- Interactive tooltip that follows cursor/touch showing: step number, dimension, predicted value, lower bound, upper bound, and spread

**Empty State (shown when no predictions):**
Display centered content with:
- Decorative layered rounded containers with gradient backgrounds and rotation animations
- Large üìä emoji in center
- Title "Create a Model to Begin"
- Subtitle explaining ESN autoregressive forecasting
- "Start with Defaults" primary button with ‚ö° emoji and gradient background
- Row with "Load" button (üì§ emoji) and "Demo" button (‚ú® emoji) with purple-to-pink gradient

**Loading State:**
Overlay with blurred background showing:
- Spinning circular loader (border animation)
- Loading text (e.g., "Processing...", "Training on uploaded data...")
- Progress bar with gradient fill (blue-500 to indigo-500) when applicable
- Progress percentage text
- "Cancel" button with red styling

---

**DIMENSION SELECTOR (Focus Mode only):**
Horizontal scrollable row of dimension buttons (D1, D2, D3, etc.) with:
- Active dimension showing its assigned color as background
- Inactive dimensions with slate background
- Each dimension gets unique color from palette: [#3B82F6, #10B981, #F59E0B, #EF4444, #8B5CF6, #EC4899, #06B6D4, #84CC16, #F97316, #14B8A6]

---

**STEP SELECTOR (Snapshot Mode only):**
Input field for selecting which prediction step to display, with label "Step:" and numeric input showing current step.

---

**STATISTICS BAR (Focus Mode only):**
Six-column grid (3 columns on mobile) showing:
- Min value
- Max value  
- Mean value
- Final value
- Trend (with colored arrow ‚Üë green or ‚Üì red and absolute change)
- Confidence percentage

Each stat in its own rounded card with glass effect, uppercase tiny label, and bold value.

---

**SIDE PANEL (Details Panel):**

Fixed panel on desktop (320px width), slide-in overlay on mobile (85% width, max 384px). Contains:

**Model Metrics Section:**
- "Model Metrics" header with uppercase styling
- Rows showing: Samples Trained (blue highlight), Avg Loss (exponential notation), Gradient Norm (exponential notation), Sample Weight (3 decimals)

**Prediction Section:**
- "Prediction" header
- "Future Steps" label with numeric input (no range restriction, allow any positive integer)
- "Run Prediction" button with gradient, disabled state when no model

**Event Log Section:**
- "Event Log" header with filter dropdown (All, Info, Success, Warning, Error)
- Search input for filtering logs
- Scrollable list of log entries, each showing:
  - Colored category label (blue=info, emerald=success, amber=warning, red=error)
  - Timestamp
  - Message text
- Maximum 200 log entries stored, display latest 50

Mobile: Panel has overlay backdrop that closes panel when tapped.

---

**MAIN MENU (Slide-out):**

Full-height slide-out panel from right side with sections:

**Model Section (üìÅ emoji header):**
- "Create & Configure" with üéõÔ∏è emoji, blue icon background, description "Set up model parameters"
- "Save & Load" with üíæ emoji, emerald icon background, description "Persist your models"

**Data Section (üìÇ emoji header):**
- "Upload Dataset" with üì§ emoji, purple icon background, description "Import time series data"
- "Manual Insert" with ‚ûï emoji, amber icon background, description "Add individual time steps"

**Test Section (üß™ emoji header):**
- "Random Test" with üí° emoji, pink icon background, description "Generate synthetic time series"

**Advanced Section (‚öôÔ∏è emoji header):**
- "Settings" with üîß emoji, slate icon background, description "Module URL & preferences"
- "View Data Table" with üìã emoji, slate icon background, description "Raw prediction values"
- "Help" with ‚ùì emoji, slate icon background

Each menu item should be a full-width button with icon container, title, description, and hover states.

---

**CONFIGURATION MODAL:**

Full-screen on mobile, centered card (max-width 768px) on desktop with:

**Header:**
- Title "Model Configuration"
- Close button with ‚úñÔ∏è emoji

**Presets Bar:**
- Horizontal scrollable row with preset buttons: "Start Here" (blue highlight), "Fast", "Balanced", "Accurate", "Adaptive", "Robust"

**Configuration Sections (collapsible):**

Each section has toggle header with chevron (‚ñº/‚ñ≤) and collapsible content:

1. **Reservoir Architecture:**
   - reservoirSize (number input, default: 256) - "Neurons in reservoir"
   - spectralRadius (number input, default: 0.9) - "Memory length control"
   - leakRate (number input, default: 0.3) - "Temporal smoothing"
   - inputScale (number input, default: 1.0) - "Input scaling factor"
   - biasScale (number input, default: 0.1) - "Bias scaling"
   - reservoirSparsity (number input, default: 0.9) - "Zero connections"
   - inputSparsity (number input, default: 0.0) - "Input sparsity"
   - activation (select: tanh, relu, default: tanh) - "Activation function"

2. **Readout Configuration:**
   - useInputInReadout (toggle switch, default: true) - "Append input to state"
   - useBiasInReadout (toggle switch, default: true) - "Include bias term"

3. **Training (RLS):**
   - readoutTraining (fixed display: "rls") - "RLS training"
   - rlsLambda (number input, default: 0.999) - "Forgetting factor"
   - rlsDelta (number input, default: 1.0) - "Initial P diagonal"
   - epsilon (number input, default: 1e-8) - "Numerical stability"
   - l2Lambda (number input, default: 0.0001) - "L2 regularization"
   - gradientClipNorm (number input, default: 1.0) - "Max update norm"

4. **Normalization:**
   - normalizationEpsilon (number input, default: 1e-8) - "Stability constant"
   - normalizationWarmup (number input, default: 10) - "Warmup samples"

5. **Outlier Handling:**
   - outlierThreshold (number input, default: 3.0) - "Z-score threshold"
   - outlierMinWeight (number input, default: 0.1) - "Outlier min weight"

6. **Uncertainty:**
   - uncertaintyMultiplier (number input, default: 1.96) - "CI Multiplier (1.96 = 95% CI)"

7. **Initialization:**
   - weightInitScale (number input, default: 0.1) - "Initial weight scale"
   - seed (number input, default: 42) - "Random seed"
   - verbose (toggle switch, default: false) - "Detailed logging"

**Footer:**
- "Reset Defaults" button (slate)
- "Reset All" button (red styling)
- "Cancel" button (slate)
- "Create Model" button (gradient blue-indigo)

---

**LIBRARY USAGE DOCUMENTATION SECTION:**

Include a dedicated help/documentation area accessible from the menu that explains:

**Worker Setup:**
```
The ESNRegression library runs in a Web Worker for non-blocking performance.
Module URL: https://cdn.esm.sh/jsr/@hviana/multivariate-regression@1.4.0
```

**Method Calls:**

1. **Creating a Model:**
```javascript
const model = new ESNRegression(config);
// config contains all parameters from Configuration Modal
```

2. **Online Training (fitOnline):**
```javascript
model.fitOnline({ coordinates: [[x1,y1,z1], [x2,y2,z2]] });
// Trains on consecutive time step pairs
// Returns: { averageLoss, gradientNorm, sampleWeight }
```

3. **Prediction:**
```javascript
const result = model.predict(futureSteps);
// Returns: { predictions, lowerBounds, upperBounds, confidence }
// Each is array of arrays [step][dimension]
```

4. **Save/Load:**
```javascript
const state = model.save(); // Returns serialized model string
model.load(state); // Restores from serialized string
```

5. **Model Summary:**
```javascript
const summary = model.getModelSummary();
// Returns: { nFeatures, sampleCount, ... }
```

**Default Parameters by Preset:**

- **Start Here/Default:** reservoirSize=256, spectralRadius=0.9, leakRate=0.3
- **Fast:** reservoirSize=64, reservoirSparsity=0.95
- **Balanced:** reservoirSize=256, spectralRadius=0.9
- **Accurate:** reservoirSize=512, spectralRadius=0.95, leakRate=0.2
- **Adaptive:** rlsLambda=0.97, spectralRadius=0.85, leakRate=0.5
- **Robust:** outlierThreshold=2.0, outlierMinWeight=0.05, l2Lambda=0.01, leakRate=0.2

---

**UPLOAD DATASET MODAL:**

- Drag-and-drop zone with üìÅ emoji, dashed border, hover highlight
- "Drop JSON file here or tap to browse" text
- Hidden file input accepting .json
- Textarea for pasting JSON directly
- Collapsible format example showing:
```json
{
  "coordinates": [
    [1.0, 2.0, 3.0],
    [1.1, 2.1, 3.1],
    [1.2, 2.2, 3.2]
  ]
}
```
- "Copy example" button
- Validation preview (green) showing: Dimensions count, Time Steps count, Status
- Error display (red) for invalid data
- Footer: Cancel, Validate, "Apply & Train" (disabled until validated)

---

**MANUAL INSERT MODAL:**

- Description text
- "Generate Template" button creating JSON template based on current dimensions
- Textarea for JSON input
- Validation feedback area
- Footer: Cancel, "Insert & Train"

---

**SAVE & LOAD MODAL:**

**Save Section:**
- "Download" button with üì• emoji - downloads JSON file
- "Browser" button with üíæ emoji - saves to localStorage with name prompt

**Load Section:**
- Tap-to-upload zone with üì§ emoji
- List of saved models from localStorage, each showing:
  - Model name
  - Dimension count
  - "Load" button
- "Clear all saved models" link at bottom

---

**RANDOM TEST MODAL:**

Generate synthetic time series for testing:
- Seed (number input, default: 42)
- Dimensions (number input, default: 3)
- Time Steps (number input, default: 200)
- Noise (number input, default: 0.1)
- Outliers rate (number input, default: 0.02)
- Difficulty (select: Easy, Medium, Hard)
- Footer: Cancel, "Generate & Run" (purple-pink gradient)

---

**SETTINGS MODAL:**

- Module URL input (monospace font) with current URL
- "Reinitialize Worker" button (amber styling)
- "Clear All Preferences" button (red styling)

---

**DATA TABLE MODAL:**

Full-screen modal with:
- Header with title and close button
- Scrollable table with sticky header
- Columns: Step, P1...Pn (predictions), L1...Ln (lower bounds), U1...Un (upper bounds)
- Monospace font for values
- Zebra striping on rows
- **Interactive features:**
  - Column sorting by clicking headers
  - Row highlighting on hover showing full details
  - "Export CSV" button with üìä emoji
  - "Copy All" button with üìã emoji
  - Search/filter input

---

**CHART INTERACTIVITY REQUIREMENTS:**

All chart visualizations must include:

1. **Zoom Controls:**
   - Pinch-to-zoom on touch devices
   - Scroll wheel zoom (with modifier key on desktop)
   - Floating zoom buttons (‚ûï ‚ûñ üîÑ)
   - Zoom level indicator badge

2. **Save/Export Options:**
   - "Save as PNG" button with üñºÔ∏è emoji
   - "Save as SVG" button with üìÑ emoji
   - "Copy to Clipboard" button with üìã emoji

3. **Hover/Touch Details:**
   - Tooltip following cursor showing:
     - Step number prominently displayed
     - Dimension indicator with color dot
     - Predicted value (bold)
     - Confidence interval (lower - upper)
     - Spread/uncertainty value
   - Crosshair lines on focus view
   - Highlighted point with glow effect
   - Touch-and-hold on mobile triggers same tooltip

4. **Pan/Scroll:**
   - Drag to pan when zoomed
   - Momentum scrolling on touch

---

**TOAST NOTIFICATIONS:**

Bottom-positioned container (above mobile nav on small screens) with:
- Colored backgrounds: emerald (success), amber (warning), red (error), blue (info)
- Message text
- Close button with ‚úñÔ∏è emoji
- Auto-dismiss after 4s (6s for errors)
- Slide-in animation

---

**ANIMATIONS AND TRANSITIONS:**

Define these CSS keyframe animations:
- fadeIn: opacity 0 to 1 in 0.2s
- slideUp: translateY(10px) + opacity to normal in 0.3s
- slideInRight: translateX(100%) to 0 in 0.3s
- slideInBottom: translateY(100%) to 0 in 0.3s
- pulseSubtle: opacity oscillating 1 to 0.7 in 2s infinite
- skeleton: shimmer effect for loading states

All interactive elements should have transition-colors or transition-all with appropriate durations.

---

**DARK MODE:**

Implement complete dark mode with:
- Background: gradient from slate-900 via slate-800 to slate-900
- Cards: slate-800 with transparency
- Text: slate-100 primary, slate-400 secondary
- Borders: slate-700 with transparency
- Inputs: slate-700 background
- Preserved gradient accents on buttons
- Adjusted shadow colors

Toggle between modes using class on document element, persist preference to localStorage.

---

**RESPONSIVE DESIGN:**

- Mobile-first approach
- Breakpoints: sm (640px), md (768px), lg (1024px), xl (1280px)
- Side panel hidden on mobile, toggleable with overlay
- Visualization tabs scroll horizontally on small screens
- Grid layout adjusts columns based on width
- Font sizes scale appropriately
- Touch targets minimum 44x44px
- Bottom action bar on mobile for quick predict access

---

**STATE MANAGEMENT:**

Maintain application state object tracking:
- config: all model configuration parameters
- modelExists: boolean
- nDimensions: number of dimensions
- sampleCount: training samples processed
- predictions: current prediction results
- vizMode: current visualization mode
- selectedDim: selected dimension index
- selectedStep: selected step for snapshot view
- isDark: dark mode enabled
- logs: array of log entries
- metrics: { avgLoss, gradientNorm, sampleWeight }
- zoom: { level, offsetX, visibleStart, visibleCount }
- hover: { active, x, y, dataIndex }

Persist preferences (config, vizMode, isDark) to localStorage.

---

**WEB WORKER IMPLEMENTATION:**

Create inline Web Worker that:
- Dynamically imports ESNRegression module
- Handles message types: init, createModel, train, predict, save, load, getSummary, reset, cancel
- Emits progress events during training
- Returns results with requestId for tracking
- Supports cancellation of long-running operations

---

**ERROR HANDLING:**

- Wrap all async operations in try-catch
- Display errors via toast notifications
- Log errors to event log
- Graceful degradation when worker fails
- Validation feedback for all user inputs

---

**ACCESSIBILITY:**

- ARIA labels on all interactive elements
- Role attributes on modals (dialog)
- Focus management when opening/closing modals
- Sufficient color contrast in both themes
- Screen reader friendly structure