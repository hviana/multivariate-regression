Model: Generate a single, self-contained, premium-quality HTML web application in ONE HTML file that looks and feels like a polished product, not a demo. The app must be beautiful, fast, responsive, accessible, and fully functional.

HARD CONSTRAINTS
Use Tailwind CSS ONLY (no other dependencies, no chart libraries, no UI libraries, no icon libraries, no frameworks).
All JavaScript must be inline inside the HTML (except the model module loaded inside the Worker).
Import the ESNRegression library from https://cdn.esm.sh/jsr/@hviana/multivariate-regression
The model MUST run inside a Web Worker. The main thread must never call ESNRegression directly.
The interface must contain all the parameters of the model when creating/configuring a model (organize in sections):
// ðŸ”„ Reservoir Architecture (section)
maxSequenceLength: number; // Default: 64
reservoirSize: number; // Default: 256
spectralRadius: number; // Default: 0.9
leakRate: number; // Default: 0.3
inputScale: number; // Default: 1.0
biasScale: number; // Default: 0.1
reservoirSparsity: number; // Default: 0.9
inputSparsity: number; // Default: 0.0
activation: "tanh" | "relu"; // Default: "tanh"

// ðŸ“¤ Readout Configuration (section)
useInputInReadout: boolean; // Default: true
useBiasInReadout: boolean; // Default: true

// ðŸŽ¯ Training (RLS) (section)
readoutTraining: "rls"; // Default: "rls"
rlsLambda: number; // Default: 0.999
rlsDelta: number; // Default: 1.0
epsilon: number; // Default: 1e-8
l2Lambda: number; // Default: 0.0001
gradientClipNorm: number; // Default: 1.0

// ðŸ“Š Normalization (section)
normalizationEpsilon: number; // Default: 1e-8
normalizationWarmup: number; // Default: 10

// ðŸ›¡ï¸ Outlier Handling (section)
outlierThreshold: number; // Default: 3.0
outlierMinWeight: number; // Default: 0.1

// ðŸ“ˆ Uncertainty (section)
residualWindowSize: number; // Default: 100
uncertaintyMultiplier: number; // Default: 1.96

// âš™ï¸ Initialization (section)
weightInitScale: number; // Default: 0.1
seed: number; // Default: 42
verbose: boolean; // Default: false
rollforwardMode: "holdLastX" | "autoregressive"; // Default: "holdLastX"

Every worker action must show a clear loading indicator and disable relevant controls while running.
For long operations (bulk training), show progress with processed count and percentage, and allow cancel.

OUTPUT REQUIREMENT
Output ONLY the final HTML code. No explanations. No markdown. No placeholders. No TODOs.

PRODUCT DESIGN GOAL
Make the UI visually stunning with a cohesive design system: refined typography, spacing, subtle gradients, soft shadows, crisp borders, smooth animations, and excellent information hierarchy.
Avoid clutter. Use a clean dashboard layout with a single expandable main menu that groups all actions into organized sections.
Must look excellent on mobile: touch-friendly targets, stacked layout, slide-over panels, sticky action bar when appropriate.
Include a dark mode toggle with persistent preference.

APP PURPOSE
This is an "ESN Regression Studio" for online multivariate regression and multi-horizon forecasting with n-dimensional features and targets.
Data can have many dimensions (e.g., 20+ features, 10+ targets). The UI must scale gracefully.

NAVIGATION AND LAYOUT (NO CLUTTER)
Use a premium dashboard structure:
Header with app title, model status, compact config chips, and 2â€“3 quick actions.
Main content with a large visualization card area.
Right/secondary panel area for metrics, logs, and controls (collapsible on mobile).
Expandable main menu:
Model:
    Create/Config
    Save/Load
Data:
    Upload Dataset
    Manual Insert
Test:
    Random Test
Advanced:
    Settings


WORKER ARCHITECTURE (ROBUST AND SAFE)
Implement a strict message protocol with requestId, type, payload.
Worker must support progress events for long tasks: progress { requestId, processed, total, percent, stage }.
Worker must support cancel by requestId.
Worker must keep the model instance AND dataset state internally.
Main thread must only send commands and receive summaries and decimated data for visualization.

CRITICAL WORKER MODULE LOADING STRATEGY (MUST DO ALL)
Inside the worker, load ESNRegression robustly:
First attempt dynamic import using a configurable module URL (default: https://cdn.esm.sh/jsr/@hviana/multivariate-regression).
If dynamic import fails, fallback to fetching the module as text and evaluating it in the worker to obtain ESNRegression (handle ESM wrapper carefully; implement a robust "extract exported ESNRegression" strategy).
Expose an "Advanced" UI section to change module URL at runtime and reinitialize the worker.
Never crash silently: return actionable error messages to the UI.

DATA FORMATS (MUST SUPPORT EXACTLY; EXPLAIN IN-APP)
Training dataset JSON accepted as either:
Format A: { "xCoordinates": number[][], "yCoordinates": number[][] }
Format B: { "samples": [ { "x": number[], "y": number[] }, ... ] }
Manual/stream insert accepts:
Format C: { "x": number[], "y": number[] }
Format D: { "samples": [ ... ] }
Prediction request format:
{ "futureSteps": number }
Model save/load format:
Preferred wrapper: { "modelState": string, "meta": { "config": object, "nFeatures": number, "nTargets": number, "createdAt": string, "appVersion": string } }
Also accept raw string produced by model.save() (detect and wrap on load).

VALIDATION AND ERROR UX (MUST BE EXCELLENT)
Validate every JSON input with clear, human-friendly errors that pinpoint the problem (missing keys, wrong types, NaN, mismatched lengths, inconsistent dimensions).
Never allow the app to enter a broken state. If something fails, keep previous state intact and show a toast + detailed log entry.
Include a "Validation Preview" step for uploads: show inferred nFeatures, nTargets, sample count, and a small preview table before applying.

REQUIRED MODALS / PANELS
Model Configuration modal (or mobile slide-over)
Must allow full configuration and re-instantiation.
Must include expandable explanation for EVERY parameter with: what it does, recommended ranges, tuning advice, and common failure modes (underfit/overfit/instability/unresponsive).
Must include at least 5 presets: Start Here (recommended), Fast/Light, Balanced, Accurate/Stable, Adaptive/Drift, Noisy/Robust.
Must include inline validation and smart defaults.
Must include "Reset to Defaults" and "Reset Everything" (clears model, data, logs, localStorage).

Data Upload modal
Upload JSON file and paste JSON text.
Show format examples inside the modal.
Show validation preview and confirm apply.

Manual Insert modal
Allow adding a single sample or small batch via JSON.
Show real-time validation as user types.
Optional helper UI to generate an empty template with correct dimension lengths.

Save/Load modal
Save to file and to localStorage.
Load from file and from localStorage.
Show metadata and warn about dimension mismatches with a safe confirmation flow.
Include "Clear localStorage".

Random Standard Test modal
Generate synthetic multivariate data with nonlinear relationships, noise, optional outliers, multi-target coupling.
Controls: seed, feature count, target count, sample count, difficulty, noise, outlier rate.
One-click "Generate + Train + Predict" that produces an impressive visualization immediately.
Must be deterministic by seed.
Must show a short summary of the generated ground-truth function characteristics.

TRAINING AND PREDICTION FLOWS
Support online training via fitOnline for:
Single sample insert
Batch training from uploaded dataset
Bulk training must stream progress updates and be cancelable.
Prediction controls:
futureSteps slider/input with reasonable min/max and validation.
Run prediction and show predictions, lowerBounds, upperBounds, confidence.
Display model summary and running stats: samples processed, average loss, gradient norm, sample weight/outlier indicator when available.

LOGGING, TOASTS, AND STATUS
Include toast notifications (success, warning, error) with subtle animations.
Include a persistent event log panel with filter (All, Info, Success, Warning, Error) and search.
Log entries must include timestamp, action, and details.

VISUALIZATION SYSTEM (CRITICAL - THIS IS THE MOST IMPORTANT PART)

You must implement a professional-grade custom charting engine using HTML5 Canvas. The charts must look as polished as commercial charting libraries. Every visual detail matters.

CANVAS RENDERING FUNDAMENTALS (MANDATORY)
Always render at devicePixelRatio scale for razor-sharp lines on all displays.
Set canvas.width and canvas.height to element dimensions multiplied by devicePixelRatio.
Apply ctx.scale(devicePixelRatio, devicePixelRatio) before drawing.
Use ctx.translate(0.5, 0.5) for crisp 1px lines (align to pixel grid).
Clear canvas with background color, not transparent, to avoid ghosting.
Implement proper resize observer that debounces and re-renders.

COLOR SYSTEM (DEFINE PRECISELY)
Light mode chart background: #FFFFFF
Light mode grid lines: rgba(0, 0, 0, 0.06)
Light mode axis lines: rgba(0, 0, 0, 0.15)
Light mode axis text: #64748B (slate-500)
Dark mode chart background: #1E293B (slate-800)
Dark mode grid lines: rgba(255, 255, 255, 0.06)
Dark mode axis lines: rgba(255, 255, 255, 0.15)
Dark mode axis text: #94A3B8 (slate-400)

Primary data line colors (use for different target dimensions):
#3B82F6 (blue-500), #10B981 (emerald-500), #F59E0B (amber-500), #EF4444 (red-500), #8B5CF6 (violet-500), #EC4899 (pink-500), #06B6D4 (cyan-500), #84CC16 (lime-500)

Confidence band fill: Use the line color with alpha 0.12 in light mode, 0.15 in dark mode.
Confidence band stroke: Use the line color with alpha 0.3.

CHART LAYOUT AND MARGINS
Left margin: 60px (for y-axis labels)
Right margin: 20px
Top margin: 20px
Bottom margin: 40px (for x-axis labels)
Apply padding of 10% to y-axis domain for breathing room above/below data.

AXIS AND GRID RENDERING
Generate human-friendly tick values using a nice numbers algorithm (1, 2, 5 multiples).
Y-axis: 5-7 horizontal grid lines maximum, labels formatted with appropriate precision (auto-detect decimals needed).
X-axis: Label every Nth step where N is chosen so labels don't overlap (minimum 60px between labels).
Grid lines: 1px, use dashed pattern [4, 4] for subtle appearance.
Axis lines: 1px solid on left and bottom edges only.
Axis labels: 11px font, font-family system-ui, -apple-system, sans-serif.

LINE RENDERING (CRITICAL FOR QUALITY)
Prediction lines: 2.5px lineWidth, round lineCap and lineJoin.
Apply subtle glow effect: Draw line twice - first with 6px width at 0.15 alpha, then with 2.5px at full alpha.
Use ctx.setLineDash([]) for solid prediction lines.
For actual/historical data if shown: Use 1.5px lines with 0.7 alpha.

CONFIDENCE BAND RENDERING
Draw as a filled polygon: path from first point along upper bounds, then reverse along lower bounds, close path.
Fill with gradient: vertical linear gradient from band color at 0.15 alpha to band color at 0.05 alpha.
Stroke upper and lower bounds with 1px dashed line [3, 3] at 0.4 alpha.
Bands must have smooth curves - use quadratic bezier curves between points for organic feel.

ANIMATION SYSTEM
When new predictions arrive, animate lines drawing from left to right over 600ms using ease-out-cubic.
When switching dimensions, crossfade with 200ms opacity transition.
Animate y-axis rescaling smoothly over 300ms.
Use requestAnimationFrame for all animations.
Store animation state and allow interruption for new data.

HOVER INTERACTIVITY (MUST BE SMOOTH AND INFORMATIVE)
Track mouse position with mousemove listener.
Draw vertical crosshair line: 1px dashed line, full chart height, using theme-appropriate color at 0.5 alpha.
Draw horizontal crosshair line from y-axis to data point.
Snap to nearest data point within 30px horizontal threshold.
Highlight snapped point with a circle: 8px outer ring at 0.3 alpha, 5px filled circle.
Display tooltip positioned to avoid chart edges.

TOOLTIP DESIGN (MUST BE ELEGANT)
Background: Light mode white with shadow, dark mode slate-700.
Border radius: 8px
Padding: 12px 16px
Shadow: 0 4px 20px rgba(0,0,0,0.15)
Show: Step index, predicted value (formatted to 4 significant digits), lower bound, upper bound, band width.
Position: 15px offset from cursor, flip sides when near edges.
Animate opacity on show/hide with 150ms transition.
Include small arrow pointing to data point.

ZOOM AND PAN CONTROLS
Provide zoom buttons: zoom in, zoom out, reset zoom (fit all).
Zoom centers on current view center or on cursor position if hovering.
Implement wheel zoom: ctrl+wheel or pinch on touch devices.
Show current zoom level indicator.
When zoomed, show a mini-map overview in corner (small rectangle showing viewport position).
Animate zoom transitions over 250ms.


VISUALIZATION MODES (ALL MUST BE BEAUTIFUL)

MODE 1: SMALL MULTIPLES GRID
Render one mini chart per target dimension in a responsive grid.
Grid: 2 columns on mobile, 3 on tablet, 4-5 on desktop.
Each mini chart: minimum 200px width, 120px height.
Mini charts show: prediction line, confidence band, dimension label, final value badge.
No axis labels on mini charts (too cluttered), but show faint grid.
Hover on mini chart shows quick tooltip with dimension stats.
Click mini chart opens Focus view for that dimension.
If more than 20 dimensions, virtualize the grid (only render visible).

MODE 2: FOCUS VIEW (LARGE SINGLE CHART)
Full-width chart taking available height (minimum 400px).
Complete axis labels and grid.
Dimension selector dropdown above chart.
Show prediction line, confidence band, optional markers at key points.
Full hover interactivity with detailed tooltip.
Display summary stats below chart: min, max, mean, final value, trend direction, confidence.
Zoom and pan controls visible.
Export PNG button.

MODE 3: HEATMAP VIEW
Rows: target dimensions (y-axis)
Columns: future steps (x-axis)
Cell coloring: Use a perceptually uniform color scale.
Light mode: White (low) -> Blue (mid) -> Purple (high) or diverging scale if data has negative values.
Dark mode: Dark blue (low) -> Cyan (mid) -> Yellow (high).
Show color scale legend on right side.
Cell size: minimum 20px, scale up to fill space.
Hover shows tooltip with exact values.
Row labels (dimension names/indices) sticky on left when scrolling horizontally.
Column headers (step indices) sticky on top when scrolling vertically.
Optional: Normalize per row for relative comparison.

MODE 4: UNCERTAINTY VIEW
Primary visualization: Band width (upper - lower) per step.
Render as area chart showing uncertainty magnitude.
Color code by relative uncertainty: green (low/confident) -> yellow (medium) -> red (high/uncertain).
Show confidence score prominently as large number with gauge visualization.
Option to overlay multiple dimensions for comparison.
Show statistics: average uncertainty, max uncertainty step, uncertainty trend.

MODE 5: SNAPSHOT BAR CHART
For a selected future step, show horizontal bar chart of all target values.
Bars show predicted value with error bars for bounds.
Sort options: by index, by value ascending, by value descending, by uncertainty.
Color bars by value magnitude or by uncertainty.
Hover shows detailed values.
Animate bars on step change.

DIMENSION SELECTOR PANEL
Search box with real-time filtering.
List of dimensions with: index, name (if available), checkbox for multi-select.
Show mini sparkline preview next to each dimension (tiny 50x20 canvas).
Pin favorite dimensions (persist in localStorage).
Batch actions: Select All, Clear All, Select Top K by variance, Select Top K by magnitude.
If more than 30 dimensions, virtualize the list.
Selected dimensions shown as chips above the list.

EMPTY AND LOADING STATES
Empty state (no model): Beautiful illustration (CSS-only geometric shapes), message "Create a model to begin", prominent CTA button.
Empty state (no predictions): Message "Run a prediction to see results", show last configuration summary if available.
Loading state: Skeleton placeholders that pulse, maintain layout dimensions.
Error state: Clear error message with suggested actions, retry button.

CHART EXPORT
Export Focus view and Heatmap as PNG.
Add padding around exported image.
Include title, timestamp, and key stats in export.
Offer 1x, 2x, 3x resolution options.

PERFORMANCE REQUIREMENTS
Keep UI responsive at all times.
Do not re-render charts unnecessarily; use requestAnimationFrame and only redraw when needed.
Use decimation/downsampling when futureSteps or dims are large.
Cache rendered canvases when data hasn't changed.
Debounce resize handlers (150ms).

ACCESSIBILITY REQUIREMENTS
All modals must trap focus and close on Escape.
All controls must have ARIA labels and visible focus styles.
Color contrast must be sufficient; do not rely on color alone for meaning.
Provide pattern fills as alternative to colors for confidence bands in accessibility mode.
Keyboard shortcuts:
M opens menu
C opens config
U opens upload
P runs prediction (when possible)

PERSISTENCE
Persist theme, last used config, last selected view, and UI preferences in localStorage.
Model state persistence must be explicit via Save/Load actions.

DEFAULT ONBOARDING (MAKE IT FEEL GREAT)
When the app opens with no model, show a beautiful onboarding card with 3 big buttons:
Start Here preset (creates model)
Load model
Run Standard Test
After running Standard Test, automatically switch to the most impressive visualization mode and highlight key controls.

QUALITY GATE BEFORE OUTPUT
Before outputting the HTML, internally verify:
All required features exist and are wired.
Worker runs the model and main thread does not.
Worker loading strategy is robust with fallback.
All JSON flows are validated with friendly errors.
Charts are high-quality, interactive, responsive, and visually polished.
No external dependencies besides Tailwind CSS CDN.
No markdown, no explanation, only HTML code output.

README OF LIBRARY:
(lib README.md)
